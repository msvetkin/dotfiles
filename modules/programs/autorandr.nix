# Some settings from https://pastebin.com/S8m1jnY3
{ config, pkgs, ... }:

{
  programs.autorandr = {
    enable = true;
    profiles = {
      adama = {
        fingerprint = {
          DP-0 = "00ffffffffffff0010aceca04c5935300b1d0104b53d23783eee95a3544c99260f5054a54b00714f8180a9c0a940d1c0e100d10001014dd000a0f0703e8030203500615d2100001a000000ff00464e38344b3933413035594c0a000000fc0044454c4c205532373138510a20000000fd0031560a8936000a20202020202001e102031df150101f200514041312110302161507060123091f0783010000565e00a0a0a0295030203500615d2100001aa36600a0f0701f8030203500615d2100001a4dd000a0f0703e8030203500615d2100001a023a801871382d40582c2500615d2100001ebf1600a08038134030203a00615d2100001a00000000000000004a";
          HDMI-0 = "00ffffffffffff0030aee96100000000101f0103803c22782e6665a9544c9d26105054a1080081809500b300d1c0d100a9c081c08100565e00a0a0a0295030203500615d2100001a000000fc00503237682d32300a2020202020000000fd00324c1e5a22000a202020202020000000ff0056393037545747390a2020202001b202031ff14c01020304051413901f120e0f23090f078301000065030c001000011d007251d01e206e28550055502100001e8c0ad08a20e02d10103e960055502100001800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000094";
        };
        config = {
          DP-0 = {
            enable = true;
            crtc = 0;
            mode = "3840x2160";
            position = "3328x0";
            primary = true;
            rate = "60.00";
            # dpi = 144;
            # x-prop-non_desktop = 0;
          };
          HDMI-0 = {
            crtc = 1;
            primary = false;
            position = "0x0";
            mode = "2560x1440";
            filter = "bilinear";
            rate = "59.95";
            # x-prop-non_desktop = 0;
            transform = [
              [ 1.299988 0.000000 0.000000 ]
              [ 0.000000 1.299988 0.000000 ]
              [ 0.000000 0.000000 1.000000 ]
            ];
          };
        };
      };
      galactica = {
        fingerprint = {
          DP-2-8 = "00ffffffffffff0030aee96100000000111f0104a53c22783e6665a9544c9d26105054a1080081c0810081809500a9c0b300d1c00101565e00a0a0a0295030203500615d2100001a000000fc00503237682d32300a2020202020000000fd00324c1e5a24000a202020202020000000ff0056393037545731370a202020200160020318f14b9005040302011f13140e0f23090f0783010000662156aa51001e30468f33000f282100001eab22a0a050841a30302036000f282100001c7c2e90a0601a1e40302036000f282100001c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a";
          HDMI-1 = "00ffffffffffff0009d13d804554000032200103804627782e6875a6564fa2260e5054a56b80d1c0b300a9c08180810081c0010101014dd000a0f0703e8030203500b9882100001a000000ff0044434e30303235333031390a20000000fd00324c1e873c000a202020202020000000fc0042656e5120504433323035550a017302034df14f5d5e5f6061101f22212004131203012309070783010000e200cf6d030c001000383c20006001020367d85dc401788003681a00000101283ce6e305c301e30f1800e6060501626200565e00a0a0a0295030203500b9882100001e4d6c80a070703e8030203a00b9882100001a0000000000000000000000000000ba";
          DP-2-1 = "00ffffffffffff0030aea163484637482c210104b53c22783e3825af4f46a5250f5054b54f008180818a9500b300d1c0d100714f8100565e00a0a0a029503020350055502100001a000000ff0056333042483746480a20202020000000fd00324b1e721e010a202020202020000000fc00503237682d33300a20202020200195020327f1490103020413901f1211230907078301000065030c001000e305c000e606050161561ccc7400a0a0a01e503020350055502100001a662156aa51001e30468f330055502100001e483f403062b0324040c0130055502100001e0000000000000000000000000000000000000000000000000000000000000000000085";
        };
        config = {
          DP-2-8 = {
            crtc = 2;
            filter = "bilinear";
            mode = "2560x1440";
            position = "0x0";
            rate = "59.95";
            transform = [
              [ 1.299988 0.000000 0.000000 ]
              [ 0.000000 1.299988 0.000000 ]
              [ 0.000000 0.000000 1.000000 ]
            ];
          };
          HDMI-1 = {
            crtc = 1;
            filter = "bilinear";
            mode = "3840x2160";
            position = "3328x0";
            rate = "60.00";
          };
          DP-2-1 = {
            crtc = 2;
            filter = "bilinear";
            mode = "2560x1440";
            position = "7552x0";
            rate = "59.95";
            rotate = "left";
            transform = [
              [ 1.299988 0.000000 0.000000 ]
              [ 0.000000 1.299988 0.000000 ]
              [ 0.000000 0.000000 1.000000 ]
            ];
          };
        };
      };
    };
    hooks = {
      postswitch = {
        notify-i3 = "${pkgs.i3}/bin/i3-msg restart";
        #change-background = "${pkgs.variety}/bin/variety --next";
        change-dpi = ''
          case "$(hostname)" in
            default)
              DPI=96
              ;;
            adama)
              DPI=144
              ;;
            galactica)
              DPI=138
              ;;
            *)
              echo "Unknown profile for host: $(hostname)"
              exit 1
          esac

          echo "Xft.dpi: $DPI" | xrdb -merge
        '';
      };
    };
  };

  services.autorandr.enable = true;
}
